<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SHAMELESS Blackjack</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron&display=swap');
  body {
    margin: 0;
    background: #100016;
    color: #b59bff;
    font-family: 'Orbitron', sans-serif;
    user-select: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
  }
  h1 {
    margin-bottom: 10px;
    color: #9a65ff;
    text-shadow: 0 0 8px #7a3fff;
  }
  #game {
    background: #1c0a36;
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0 0 30px #6b3fff88;
    width: 380px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .hand-container {
    display: flex;
    justify-content: center;
    margin: 10px 0;
  }
  #dealer-hand, #player-hand {
    display: flex;
    gap: 10px;
  }
  .card {
    width: 60px;
    height: 90px;
    background: linear-gradient(145deg, #22003c, #4e1f91);
    border-radius: 8px;
    color: #f8f4ff;
    position: relative;
    box-shadow: 0 0 6px #7a3fffaa;
    text-align: center;
    font-weight: 900;
    font-size: 20px;
    cursor: default;
    transform-style: preserve-3d;
    transition: transform 0.3s ease;
  }
  .card.red {
    color: #ff5873;
  }
  .card.back {
    background: linear-gradient(145deg, #40005c, #9a65ff);
    box-shadow: inset 0 0 10px #6a3fffcc;
  }
  .card .top-left, .card .bottom-right {
    position: absolute;
    font-size: 14px;
    line-height: 14px;
  }
  .card .top-left {
    top: 5px;
    left: 6px;
  }
  .card .bottom-right {
    bottom: 5px;
    right: 6px;
    transform: rotate(180deg);
  }
  .card .center {
    font-size: 40px;
    line-height: 90px;
  }

  /* Buttons */
  button {
    margin: 6px 8px 12px 8px;
    background: #3e1a90;
    border: none;
    color: #d4bfff;
    font-weight: 700;
    font-size: 16px;
    padding: 8px 18px;
    border-radius: 12px;
    box-shadow: 0 0 12px #7a3fffaa;
    cursor: pointer;
    transition: background 0.3s ease, box-shadow 0.3s ease;
  }
  button:hover:not(:disabled) {
    background: #7a3fff;
    box-shadow: 0 0 24px #9a65ff;
  }
  button:disabled {
    background: #55307b;
    cursor: default;
    box-shadow: none;
  }

  /* Bet slider */
  #bet-slider {
    width: 320px;
    margin: 10px 0;
    -webkit-appearance: none;
    height: 6px;
    border-radius: 3px;
    background: #4b238f;
    outline: none;
    box-shadow: 0 0 8px #7a3fffaa;
    cursor: pointer;
  }
  #bet-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: #bb87ff;
    cursor: pointer;
    box-shadow: 0 0 6px #9a65ff;
    transition: background 0.2s ease;
  }
  #bet-slider::-webkit-slider-thumb:hover {
    background: #d8b7ff;
  }
  #bet-slider::-moz-range-thumb {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: #bb87ff;
    cursor: pointer;
    box-shadow: 0 0 6px #9a65ff;
    transition: background 0.2s ease;
  }
  #bet-info {
    text-align: center;
    font-weight: 700;
    font-size: 16px;
    margin-bottom: 8px;
    color: #ccbbff;
  }

  /* Chip Stack */
  #chip-stack {
    position: relative;
    width: 80px;
    height: 80px;
    margin: 0 auto 15px auto;
  }
  .chip {
    position: absolute;
    width: 60px;
    height: 18px;
    border-radius: 50% / 40%;
    background: linear-gradient(145deg, #7a3fff, #b07dff);
    box-shadow: 0 2px 5px #6a3fffcc;
    border: 2px solid #4e1f91;
    transition: transform 0.4s ease, opacity 0.4s ease;
  }
  /* Stack chips with vertical offset and random slight rotation */
  .chip:nth-child(1) { bottom: 0; left: 10px; transform: rotate(-5deg); }
  .chip:nth-child(2) { bottom: 14px; left: 15px; transform: rotate(3deg); }
  .chip:nth-child(3) { bottom: 28px; left: 5px; transform: rotate(-3deg); }
  .chip:nth-child(4) { bottom: 42px; left: 12px; transform: rotate(2deg); }
  .chip:nth-child(5) { bottom: 56px; left: 8px; transform: rotate(-2deg); }
  .chip:nth-child(6) { bottom: 70px; left: 10px; transform: rotate(4deg); }

  /* Status text */
  #status {
    font-weight: 700;
    font-size: 18px;
    height: 24px;
    color: #c9aaff;
    text-align: center;
    margin: 10px 0;
    opacity: 1;
    transition: opacity 0.6s ease;
  }

  /* Stats panel */
  #stats {
    margin-top: 15px;
    background: #220044;
    padding: 12px 16px;
    border-radius: 12px;
    width: 340px;
    color: #d6c3ff;
    font-weight: 600;
    font-size: 15px;
    box-shadow: 0 0 20px #6b3fff66 inset;
  }
  #stats h3 {
    margin: 0 0 8px 0;
    color: #b494ff;
    font-weight: 700;
    font-size: 18px;
  }
  #stats ul {
    padding-left: 18px;
    margin: 0;
  }
  #stats li {
    margin: 4px 0;
  }

</style>
</head>
<body>

<h1>SHAMELESS Blackjack</h1>
<div id="game" role="main" aria-label="Blackjack game">
  <div id="dealer" aria-label="Dealer's hand" class="hand-container">
    <div id="dealer-hand" aria-live="polite" aria-atomic="true"></div>
  </div>

  <div id="player" aria-label="Player's hand" class="hand-container">
    <div id="player-hand" aria-live="polite" aria-atomic="true"></div>
  </div>

  <div id="chip-stack" aria-live="polite" aria-atomic="true" aria-label="Player chips"></div>
  
  <div id="bet-info">Bet: 10 chips</div>
  <input type="range" id="bet-slider" min="10" max="1000" value="10" step="10" aria-label="Bet amount slider" />

  <div id="status" aria-live="polite"></div>

  <div>
    <button id="btn-hit" aria-label="Hit button">Hit</button>
    <button id="btn-stand" aria-label="Stand button">Stand</button>
    <button id="btn-deal" aria-label="Deal button">Deal</button>
  </div>

  <div id="stats" aria-label="Game statistics panel">
    <h3>Stats</h3>
    <ul>
      <li id="stat-wins">Wins: 0</li>
      <li id="stat-losses">Losses: 0</li>
      <li id="stat-pushes">Pushes: 0</li>
      <li id="stat-streak">Current Streak: 0</li>
      <li id="stat-chips">Chips: 1000</li>
    </ul>
  </div>
</div>

<script>
  // Game variables
  let deck = [];
  let playerHand = [];
  let dealerHand = [];
  let playerChips = 1000;
  let currentBet = 10;

  // Stats
  let wins = 0;
  let losses = 0;
  let pushes = 0;
  let streak = 0; // positive = wins, negative = losses, zero = neutral

  // DOM refs
  const dealerHandDiv = document.getElementById('dealer-hand');
  const playerHandDiv = document.getElementById('player-hand');
  const statusDiv = document.getElementById('status');
  const btnHit = document.getElementById('btn-hit');
  const btnStand = document.getElementById('btn-stand');
  const btnDeal = document.getElementById('btn-deal');
  const chipStackDiv = document.getElementById('chip-stack');
  const betSlider = document.getElementById('bet-slider');
  const betInfo = document.getElementById('bet-info');

  // Stats elements
  const statWins = document.getElementById('stat-wins');
  const statLosses = document.getElementById('stat-losses');
  const statPushes = document.getElementById('stat-pushes');
  const statStreak = document.getElementById('stat-streak');
  const statChips = document.getElementById('stat-chips');

  // Suits & values
  const suits = ['♠', '♥', '♣', '♦'];
  const values = ['A','2','3','4','5','6','7','8','9','10','J','Q','K'];

  // Build a deck
  function buildDeck() {
    deck = [];
    for (let s of suits) {
      for (let v of values) {
        deck.push({suit: s, val: v});
      }
    }
  }

  // Shuffle deck
  function shuffleDeck() {
    for (let i = deck.length -1; i > 0; i--) {
      const j = Math.floor(Math.random()*(i+1));
      [deck[i], deck[j]] = [deck[j], deck[i]];
    }
  }

  // Calculate hand value with ace logic
  function handValue(hand) {
    let val = 0;
    let aces = 0;
    for (let c of hand) {
      if (['J','Q','K'].includes(c.val)) val += 10;
      else if (c.val === 'A') {
        aces++;
        val += 11;
      } else {
        val += parseInt(c.val);
      }
    }
    while (val > 21 && aces > 0) {
      val -= 10;
      aces--;
    }
    return val;
  }

  // Render hand cards with animation and dealer's hidden card logic
  function renderHand(hand, container, hideSecond=false) {
    container.innerHTML = '';
    hand.forEach((card, i) => {
      const cardDiv = document.createElement('div');
      cardDiv.classList.add('card');
      if (card.suit === '♥' || card.suit === '♦') cardDiv.classList.add('red');
      if (hideSecond && i === 1) {
        cardDiv.classList.add('back');
      } else {
        cardDiv.innerHTML = `
          <div class="top-left">${card.val}<br>${card.suit}</div>
          <div class="center">${card.suit}</div>
          <div class="bottom-right">${card.val}<br>${card.suit}</div>
        `;
      }
      container.appendChild(cardDiv);
    });
  }

  // Update chip stack visual with animation
  function updateChipStack(amount) {
    chipStackDiv.innerHTML = '';
    const chipsToShow = Math.min(Math.floor(amount / 10), 6);
    for (let i = 0; i < chipsToShow; i++) {
      const chip = document.createElement('div');
      chip.classList.add('chip');
      chip.style.opacity = '0';
      chipStackDiv.appendChild(chip);
      // Animate fade in and slight rise
      setTimeout(() => {
        chip.style.opacity = '1';
        chip.style.transform = 'translateY(-5px) rotate(' + (Math.random()*10-5) + 'deg)';
      }, 100 * i);
    }
  }

  // Update status text with fade
  function setStatus(text) {
    statusDiv.style.opacity = '0';
    setTimeout(() => {
      statusDiv.textContent = text;
      statusDiv.style.opacity = '1';
    }, 300);
  }

  // Update stats panel
  function updateStats() {
    statWins.textContent = `Wins: ${wins}`;
    statLosses.textContent = `Losses: ${losses}`;
    statPushes.textContent = `Pushes: ${pushes}`;
    statStreak.textContent = `Current Streak: ${streak > 0 ? '+' + streak : streak}`;
    statChips.textContent = `Chips: ${playerChips}`;
  }

  // Reset buttons states
  function resetButtons() {
    btnDeal.disabled = false;
    btnHit.disabled = true;
    btnStand.disabled = true;
  }

  // Enable hit/stand buttons
  function enablePlayButtons() {
    btnDeal.disabled = true;
    btnHit.disabled = false;
    btnStand.disabled = false;
  }

  // Start new round
  function deal() {
    if (playerChips < currentBet) {
      setStatus('Not enough chips to bet!');
      return;
    }
    playerChips -= currentBet;
    updateStats();
    updateChipStack(playerChips);
    setStatus('Dealing cards...');
    playerHand = [];
    dealerHand = [];
    buildDeck();
    shuffleDeck();

    // Deal initial cards with slight delay animation
    playerHand.push(deck.pop());
    dealerHand.push(deck.pop());
    playerHand.push(deck.pop());
    dealerHand.push(deck.pop());

    renderHand(playerHand, playerHandDiv, false);
    renderHand(dealerHand, dealerHandDiv, true);
    updateChipStack(playerChips);

    enablePlayButtons();

    if (handValue(playerHand) === 21) {
      setTimeout(() => {
        stand(); // Auto-stand on blackjack
      }, 1200);
    }
  }

  // Player hits
  function hit() {
    playerHand.push(deck.pop());
    renderHand(playerHand, playerHandDiv, false);
    const val = handValue(playerHand);
    if (val > 21) {
      endRound('bust');
    } else if (val === 21) {
      stand();
    } else {
      setStatus(`Your hand: ${val}`);
    }
  }

  // Player stands, dealer plays
  function stand() {
    btnHit.disabled = true;
    btnStand.disabled = true;
    renderHand(dealerHand, dealerHandDiv, false);
    let dealerVal = handValue(dealerHand);
    let playerVal = handValue(playerHand);
    setStatus("Dealer's turn...");
    
    // Dealer hits until 17 or more
    const dealerPlay = () => {
      if (dealerVal < 17) {
        dealerHand.push(deck.pop());
        renderHand(dealerHand, dealerHandDiv, false);
        dealerVal = handValue(dealerHand);
        setTimeout(dealerPlay, 800);
      } else {
        setTimeout(() => endRound('stand'), 500);
      }
    };
    setTimeout(dealerPlay, 800);
  }

  // End round and update chips & stats
  function endRound(cause) {
    const playerVal = handValue(playerHand);
    const dealerVal = handValue(dealerHand);
    let resultText = '';
    let payout = 0;

    if (cause === 'bust') {
      resultText = `You busted with ${playerVal}. You lose.`;
      losses++;
      streak = streak > 0 ? -1 : streak -1;
    } else {
      if (dealerVal > 21 || playerVal > dealerVal) {
        resultText = `You win! Your ${playerVal} beats dealer's ${dealerVal}.`;
        payout = currentBet * 2;
        wins++;
        streak = streak >= 0 ? streak + 1 : 1;
      } else if (playerVal < dealerVal) {
        resultText = `You lose. Dealer has ${dealerVal}, you have ${playerVal}.`;
        losses++;
        streak = streak > 0 ? -1 : streak -1;
      } else {
        resultText = `Push! Both have ${playerVal}.`;
        payout = currentBet;
  // Player stands, dealer plays
  function stand() {
    btnHit.disabled = true;
    btnStand.disabled = true;
    setStatus("Dealer's turn...");

    // Reveal dealer's hidden card
    renderHand(dealerHand, dealerHandDiv, false);

    // Dealer hits until 17 or more
    let dealerVal = handValue(dealerHand);
    function dealerPlay() {
      dealerVal = handValue(dealerHand);
      if (dealerVal < 17) {
        dealerHand.push(deck.pop());
        renderHand(dealerHand, dealerHandDiv, false);
        setTimeout(dealerPlay, 800);
      } else {
        endRound();
      }
    }
    setTimeout(dealerPlay, 1000);
  }

  // End round and update stats, chips, streaks, status
  function endRound(bustReason) {
    const playerVal = handValue(playerHand);
    const dealerVal = handValue(dealerHand);
    let outcome = '';
    let winnings = 0;

    if (bustReason === 'bust') {
      outcome = 'You busted! You lose.';
      losses++;
      streak = streak > 0 ? -1 : streak - 1;
    } else if (playerVal > 21) {
      outcome = 'You busted! You lose.';
      losses++;
      streak = streak > 0 ? -1 : streak - 1;
    } else if (dealerVal > 21) {
      outcome = 'Dealer busted! You win!';
      winnings = currentBet * 2;
      wins++;
      streak = streak < 0 ? 1 : streak + 1;
    } else if (playerVal > dealerVal) {
      outcome = 'You win!';
      winnings = currentBet * 2;
      wins++;
      streak = streak < 0 ? 1 : streak + 1;
    } else if (playerVal < dealerVal) {
      outcome = 'You lose.';
      losses++;
      streak = streak > 0 ? -1 : streak - 1;
    } else {
      outcome = 'Push! Bet returned.';
      winnings = currentBet;
      pushes++;
      streak = 0;
    }

    playerChips += winnings;
    updateStats();
    updateChipStack(playerChips);

    setStatus(outcome);
    resetButtons();
  }

  // Update bet amount from slider
  betSlider.addEventListener('input', () => {
    currentBet = parseInt(betSlider.value);
    betInfo.textContent = `Bet: ${currentBet} chips`;
  });

  // Button event listeners
  btnDeal.addEventListener('click', () => {
    deal();
  });
  btnHit.addEventListener('click', () => {
    hit();
  });
  btnStand.addEventListener('click', () => {
    stand();
  });

  // Initial setup
  updateStats();
  updateChipStack(playerChips);
  setStatus('Place your bet and press Deal.');

</script>

</body>
</html>
