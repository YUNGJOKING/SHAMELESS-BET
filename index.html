<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SHAMELESS Blackjack - Animated Reset Fix</title>
<style>
  body {
    background: #1b0b27;
    color: #eee;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem;
    user-select: none;
  }
  h1 {
    color: #ff39a6;
    text-shadow: 0 0 8px #ff39a6;
  }
  #game {
    max-width: 600px;
    width: 100%;
    background: #2e1b44;
    border-radius: 10px;
    padding: 1rem;
    box-shadow: 0 0 20px #8a2be2aa;
  }
  #controls {
    margin-bottom: 1rem;
    display: flex;
    gap: 1rem;
    justify-content: center;
  }
  button {
    background: #ff39a6;
    border: none;
    padding: 0.6rem 1.2rem;
    color: #111;
    font-weight: bold;
    border-radius: 6px;
    cursor: pointer;
    box-shadow: 0 0 10px #ff39a6;
    transition: background 0.3s ease;
  }
  button:disabled {
    background: #6a2b5a88;
    cursor: default;
    box-shadow: none;
  }
  button:hover:not(:disabled) {
    background: #ff57be;
  }
  #betInfo {
    font-size: 1.1rem;
    margin-bottom: 1rem;
    text-align: center;
    color: #ffa3d7;
    text-shadow: 0 0 4px #ff39a6;
  }
  #stats {
    display: flex;
    justify-content: space-around;
    margin-top: 1rem;
    font-size: 0.9rem;
    color: #ddaaff;
  }
  .hand-container {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 10px 0;
    min-height: 130px;
  }
  .card {
    width: 80px;
    height: 110px;
    border-radius: 8px;
    background: #fff;
    color: black;
    font-weight: bold;
    position: relative;
    box-shadow: 0 2px 6px #0008;
    user-select: none;
    opacity: 0;
    transform: translateY(-20px);
    animation-fill-mode: forwards;
    animation-duration: 0.3s;
    animation-timing-function: ease-out;
  }
  .card.red {
    color: #d02159;
  }
  .card.back {
    background: linear-gradient(45deg, #5a206a, #3a1052);
    box-shadow: inset 0 0 5px #9f59bd;
    position: relative;
  }
  .corner {
    position: absolute;
    font-size: 1.3rem;
    font-weight: 900;
    font-family: 'Arial Black', Arial, sans-serif;
    user-select: none;
  }
  .corner.top {
    top: 6px;
    left: 8px;
  }
  .corner.bottom {
    bottom: 6px;
    right: 8px;
    transform: rotate(180deg);
  }
  .suit {
    position: absolute;
    font-size: 4rem;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none;
  }
  #status {
    margin-top: 1rem;
    font-size: 1.2rem;
    text-align: center;
    color: #ff7bc7;
    text-shadow: 0 0 5px #ff39a6;
    min-height: 32px;
  }
  /* Bet slider */
  input[type=range] {
    width: 100%;
    margin-bottom: 0.5rem;
  }
  /* Chips styling */
  .chips-container {
    position: relative;
    height: 40px;
    margin-top: 0.5rem;
  }
  .chip {
    position: absolute;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    border: 2px solid #fff;
    box-sizing: border-box;
    opacity: 0;
    transform: translateY(20px);
    animation-fill-mode: forwards;
    animation-duration: 0.4s;
    animation-timing-function: ease-out;
  }
  .chip.red {
    background: #ff39a6;
    border-color: #ff67c4;
    box-shadow: 0 0 6px #ff39a6;
  }
  .chip.black {
    background: #333;
    border-color: #ddd;
    box-shadow: 0 0 6px #aaa;
  }
  /* Animations */
  @keyframes slideIn {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  @keyframes pulseGlow {
    0%, 100% {
      box-shadow: 0 0 8px #ff39a6;
    }
    50% {
      box-shadow: 0 0 16px #ff57be;
    }
  }
</style>
</head>
<body>
  <h1>SHAMELESS Blackjack</h1>
  <div id="game">
    <div id="controls">
      <button id="btnDeal">Deal</button>
      <button id="btnHit" disabled>Hit</button>
      <button id="btnStand" disabled>Stand</button>
      <button id="btnReset">Reset</button>
    </div>
    <div>
      <input type="range" id="betSlider" min="10" max="500" step="10" value="50" />
      <div id="betInfo">Bet: 50 chips</div>
    </div>

    <div>
      <h3>Your Hand</h3>
      <div id="playerHand" class="hand-container"></div>
      <div class="chips-container" id="chipsPlayer"></div>
    </div>

    <div>
      <h3>Dealer's Hand</h3>
      <div id="dealerHand" class="hand-container"></div>
      <div class="chips-container" id="chipsBet"></div>
    </div>

    <div id="status">Place your bet and press Deal.</div>

    <div id="stats">
      <div>Wins: <span id="wins">0</span></div>
      <div>Losses: <span id="losses">0</span></div>
      <div>Pushes: <span id="pushes">0</span></div>
      <div>Streak: <span id="streak">0</span></div>
      <div>Chips: <span id="totalChips">1000</span></div>
    </div>
  </div>

<script>
  // Variables
  const suits = ['♠', '♣', '♥', '♦'];
  const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
  let deck = [];
  let playerHand = [];
  let dealerHand = [];

  let wins = 0;
  let losses = 0;
  let pushes = 0;
  let streak = 0;
  let playerChips = 1000;
  let currentBet = 50;

  // DOM elements
  const btnDeal = document.getElementById('btnDeal');
  const btnHit = document.getElementById('btnHit');
  const btnStand = document.getElementById('btnStand');
  const btnReset = document.getElementById('btnReset');

  const playerHandContainer = document.getElementById('playerHand');
  const dealerHandContainer = document.getElementById('dealerHand');
  const statusDiv = document.getElementById('status');
  const betSlider = document.getElementById('betSlider');
  const betInfo = document.getElementById('betInfo');
  const statsDiv = document.getElementById('stats');
  const winsSpan = document.getElementById('wins');
  const lossesSpan = document.getElementById('losses');
  const pushesSpan = document.getElementById('pushes');
  const streakSpan = document.getElementById('streak');
  const totalChipsSpan = document.getElementById('totalChips');
  const chipsPlayerDiv = document.getElementById('chipsPlayer');
  const chipsBetDiv = document.getElementById('chipsBet');

  function createDeck() {
    deck = [];
    for (let suit of suits) {
      for (let value of values) {
        deck.push({ suit, value });
      }
    }
  }

  function shuffleDeck() {
    for (let i = deck.length -1; i > 0; i--) {
      let j = Math.floor(Math.random() * (i + 1));
      [deck[i], deck[j]] = [deck[j], deck[i]];
    }
  }

  function cardValue(card) {
    if (['J','Q','K'].includes(card.value)) return 10;
    if (card.value === 'A') return 11;
    return parseInt(card.value);
  }

  function calculateHandValue(hand) {
    let value = 0;
    let aceCount = 0;
    for (let card of hand) {
      value += cardValue(card);
      if (card.value === 'A') aceCount++;
    }
    while (value > 21 && aceCount > 0) {
      value -= 10;
      aceCount--;
    }
    return value;
  }

  // Animate card sliding in
  function animateCard(cardDiv, delayIndex) {
    cardDiv.style.animationName = 'slideIn';
    cardDiv.style.animationDelay = (delayIndex * 150) + 'ms';
  }

  function renderCard(card, hidden = false, animationIndex = 0) {
    const cardDiv = document.createElement('div');
    cardDiv.classList.add('card');
    if (hidden) {
      cardDiv.classList.add('back');
      // Immediately show back card (no animation)
      cardDiv.style.opacity = 1;
      cardDiv.style.transform = 'translateY(0)';
      return cardDiv;
    }

    const redSuits = ['♥', '♦'];
    if (redSuits.includes(card.suit)) cardDiv.classList.add('red');

    const cornerTop = document.createElement('div');
    cornerTop.classList.add('corner', 'top');
    cornerTop.textContent = card.value + card.suit;
    cardDiv.appendChild(cornerTop);

    const centerSuit = document.createElement('div');
    centerSuit.classList.add('suit');
    centerSuit.textContent = card.suit;
    cardDiv.appendChild(centerSuit);

    const cornerBottom = document.createElement('div');
    cornerBottom.classList.add('corner', 'bottom');
    cornerBottom.textContent = card.value + card.suit;
    cardDiv.appendChild(cornerBottom);

    animateCard(cardDiv, animationIndex);
    return cardDiv;
  }

  // Render hand with animation stagger
  function renderHand(hand, container, hideSecondCard = false) {
    container.innerHTML = '';
    hand.forEach((card, i) => {
      const hidden = hideSecondCard && i === 1;
      container.appendChild(renderCard(card, hidden, i));
    });
  }

  function updateStats(pulse = false) {
    winsSpan.textContent = wins;
    lossesSpan.textContent = losses;
    pushesSpan.textContent = pushes;
    streakSpan.textContent = streak;
    totalChipsSpan.textContent = playerChips;
    renderChips(chipsPlayerDiv, playerChips);
    renderChips(chipsBetDiv, currentBet);

    if (pulse) {
      totalChipsSpan.style.animation = 'pulseGlow 1s ease-in-out';
      setTimeout(() => {
        totalChipsSpan.style.animation = '';
      }, 1000);
    }
  }

  // Animate chips stacking with fade/slide
  function renderChips(container, amount) {
    container.innerHTML = '';
    const chipValue = 100;
    const chipCount = Math.floor(amount / chipValue);
    const remainder = amount % chipValue;

    // 100-chip stacks (red chips)
    for (let i = 0; i < chipCount; i++) {
      const chip = document.createElement('div');
      chip.classList.add('chip', 'red');
      chip.style.top = (i * -6) + 'px';
      chip.style.left = (i * 6) + 'px';
      chip.style.animationName = 'slideIn';
      chip.style.animationDelay = (i * 80) + 'ms';
      container.appendChild(chip);
    }
    // 10-chip stacks (black chips)
    const tens = Math.floor(remainder / 10);
    for (let i = 0; i < tens; i++) {
      const chip = document.createElement('div');
      chip.classList.add('chip', 'black');
      chip.style.top = (i * -5 + chipCount * -6) + 'px';
      chip.style.left = (i * 5 + chipCount * 6) + 'px';
      chip.style.animationName = 'slideIn';
      chip.style.animationDelay = ((chipCount + i) * 80) + 'ms';
      container.appendChild(chip);
    }
  }

  // Reset the entire game and stats
  function resetGame() {
    // Reset stats & chips
    wins = 0;
    losses = 0;
    pushes = 0;
    streak = 0;
    playerChips = 1000;
    currentBet = 50;
    betSlider.value = currentBet;
    betInfo.textContent = `Bet: ${currentBet} chips`;

    createDeck();
    shuffleDeck();

    playerHand = [];
    dealerHand = [];

    playerHandContainer.innerHTML = '';
    dealerHandContainer.innerHTML = '';
    statusDiv.textContent = 'Place your bet and press Deal.';
    btnHit.disabled = true;
    btnStand.disabled = true;
    btnDeal.disabled = false;

    updateStats(true);
  }

  function startRound() {
    if (currentBet > playerChips) {
      alert('You do not have enough chips for that bet!');
      return;
    }
    playerChips -= currentBet;
    updateStats(true);

    playerHand = [deck.pop(), deck.pop()];
    dealerHand = [deck.pop(), deck.pop()];

    renderHand(playerHand, playerHandContainer);
    renderHand(dealerHand, dealerHandContainer, true);

    btnHit.disabled = false;
    btnStand.disabled = false;
    btnDeal.disabled = true;
    statusDiv.textContent = 'Your move: Hit or Stand?';

    // Blackjack check
    if (calculateHandValue(playerHand) === 21) {
      statusDiv.textContent = 'Blackjack! You win!';
      wins++;
      streak = streak > 0 ? streak + 1 : 1;
      playerChips += currentBet * 2.5;
      updateStats(true);
      btnHit.disabled = true;
      btnStand.disabled = true;
      btnDeal.disabled = false;
    }
  }

  function dealerTurn() {
    while (calculateHandValue(dealerHand) < 17) {
      dealerHand.push(deck.pop());
    }
    renderHand(dealerHand, dealerHandContainer);
  }

  function checkWinner() {
    const playerValue = calculateHandValue(playerHand);
    const dealerValue = calculateHandValue(dealerHand);

    if (playerValue > 21) {
      statusDiv.textContent = 'Bust! You lose.';
      losses++;
      streak = streak > 0 ? 0 : streak - 1;
    } else if (dealerValue > 21) {
      statusDiv.textContent = 'Dealer busts! You win!';
      wins++;
      streak = streak > 0 ? streak + 1 : 1;
      playerChips += currentBet * 2;
    } else if (playerValue > dealerValue) {
      statusDiv.textContent = 'You win!';
      wins++;
      streak = streak > 0 ? streak + 1 : 1;
      playerChips += currentBet * 2;
    } else if (playerValue < dealerValue) {
      statusDiv.textContent = 'You lose.';
      losses++;
      streak = streak > 0 ? 0 : streak - 1;
    } else {
      statusDiv.textContent = 'Push (tie). Bet returned.';
      pushes++;
      playerChips += currentBet;
    }

    updateStats(true);
    btnHit.disabled = true;
    btnStand.disabled = true;
    btnDeal.disabled = false;
  }

  // Event Listeners
  betSlider.addEventListener('input', e => {
    currentBet = Number(e.target.value);
    betInfo.textContent = `Bet: ${currentBet} chips`;
  });

  btnDeal.addEventListener('click', () => {
    if (deck.length < 15) {
      createDeck();
      shuffleDeck();
    }
    startRound();
  });

  btnHit.addEventListener('click', () => {
    playerHand.push(deck.pop());
    renderHand(playerHand, playerHandContainer);
    if (calculateHandValue(playerHand) > 21) {
      dealerHandContainer.innerHTML = '';
      renderHand(dealerHand, dealerHandContainer); // reveal dealer cards
      statusDiv.textContent = 'Bust! You lose.';
      losses++;
      streak = streak > 0 ? 0 : streak - 1;
      btnHit.disabled = true;
      btnStand.disabled = true;
      btnDeal.disabled = false;
      updateStats(true);
    }
  });

  btnStand.addEventListener('click', () => {
    dealerTurn();
    checkWinner();
  });

  btnReset.addEventListener('click', () => {
    resetGame();
  });

  // Initialize
  resetGame();
</script>
</body>
</html>
